<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ìƒí’ˆ ë“±ë¡ - ì‡¼í•‘ëª°</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="../static/css/seller/product_regist.css"
</head>
<body class="bg-neutral-50">
    <!-- Header -->
    <header class="bg-white border-b border-neutral-200 sticky top-0 z-50">
        <div class="max-w-6xl mx-auto px-4 py-4 flex items-center gap-4">
            <button class="hover:bg-neutral-100 p-2 rounded-lg transition-colors" onclick="history.back()">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
                </svg>
            </button>
            <h1 class="text-xl font-semibold text-neutral-900">ìƒí’ˆ ë“±ë¡</h1>
        </div>
    </header>

    <!-- Main Content -->
    <main class="max-w-6xl mx-auto px-4 py-8">
        <form id="productForm" class="space-y-8">
            <!-- Product Images Section -->
            <div class="bg-white p-6 rounded-lg border border-neutral-200 shadow-sm">
                <div class="space-y-4">
                    <div>
                        <label class="text-base font-medium text-neutral-900">
                            ìƒí’ˆ ì´ë¯¸ì§€ <span class="text-red-500">*</span>
                        </label>
                        <p class="text-sm text-neutral-500 mt-1">ìµœì†Œ 4ì¥, ìµœëŒ€ 10ì¥ê¹Œì§€ ë“±ë¡ ê°€ëŠ¥í•©ë‹ˆë‹¤.</p>
                    </div>
                    
                    <input type="file" id="productImageInput" accept="image/*" multiple>
                    
                    <div class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-5 gap-4" id="productImagesGrid">
                        <!-- Upload Button -->
                        <button type="button" onclick="document.getElementById('productImageInput').click()" 
                                class="aspect-square border-2 border-dashed border-neutral-300 rounded-lg hover:border-neutral-400 hover:bg-neutral-50 transition-colors flex flex-col items-center justify-center gap-2 text-neutral-500">
                            <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
                            </svg>
                            <span class="text-sm" id="productImageCount">0/10</span>
                        </button>
                    </div>
                    
                    <p class="text-sm text-red-500" id="productImageError" style="display: none;"></p>
                </div>
            </div>

            <!-- Basic Information -->
            <div class="bg-white p-6 rounded-lg border border-neutral-200 shadow-sm">
                <h2 class="text-lg font-semibold text-neutral-900 mb-6">ê¸°ë³¸ ì •ë³´</h2>
                <div class="space-y-6">
                    <div class="grid gap-6 md:grid-cols-2">
                        <div class="space-y-2">
                            <label for="productName" class="text-sm font-medium text-neutral-700">
                                ìƒí’ˆëª… <span class="text-red-500">*</span>
                            </label>
                            <input type="text" id="productName" required 
                                   class="w-full px-3 py-2 border border-neutral-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-neutral-900 focus:border-transparent"
                                   placeholder="ìƒí’ˆëª…ì„ ì…ë ¥í•˜ì„¸ìš”">
                        </div>

                        <div class="space-y-2">
                            <label for="brand" class="text-sm font-medium text-neutral-700">
                                ë¸Œëœë“œ <span class="text-red-500">*</span>
                            </label>
                            <input type="text" id="brand" required 
                                   class="w-full px-3 py-2 border border-neutral-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-neutral-900 focus:border-transparent"
                                   placeholder="ë¸Œëœë“œëª…ì„ ì…ë ¥í•˜ì„¸ìš”">
                        </div>
                    </div>

                    <div class="space-y-2">
                        <label for="category" class="text-sm font-medium text-neutral-700">
                            ì¹´í…Œê³ ë¦¬ <span class="text-red-500">*</span>
                        </label>
                        <select id="category" required 
                                class="w-full px-3 py-2 border border-neutral-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-neutral-900 focus:border-transparent">
                            <option value="">ì¹´í…Œê³ ë¦¬ë¥¼ ì„ íƒí•˜ì„¸ìš”</option>
                            <option value="outer">ì•„ìš°í„°</option>
                            <option value="top">ìƒì˜</option>
                            <option value="bottom">í•˜ì˜</option>
                            <option value="shoes">ì‹ ë°œ</option>
                            <option value="acc">ì•¡ì„¸ì„œë¦¬</option>
                            <option value="bag">ê°€ë°©</option>
                        </select>
                    </div>

                    <div class="grid gap-6 md:grid-cols-2">
                        <div class="space-y-2">
                            <label for="price" class="text-sm font-medium text-neutral-700">
                                íŒë§¤ê°€ <span class="text-red-500">*</span>
                            </label>
                            <input type="number" id="price" required 
                                   class="w-full px-3 py-2 border border-neutral-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-neutral-900 focus:border-transparent"
                                   placeholder="0">
                        </div>

                        <div class="space-y-2">
                            <label for="discountPrice" class="text-sm font-medium text-neutral-700">í• ì¸ê°€</label>
                            <input type="number" id="discountPrice" 
                                   class="w-full px-3 py-2 border border-neutral-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-neutral-900 focus:border-transparent"
                                   placeholder="0">
                        </div>
                    </div>

                    <div class="space-y-2">
                        <label class="text-sm font-medium text-neutral-700">ì‚¬ì´ì¦ˆ</label>
                        <div class="flex flex-wrap gap-2" id="sizeButtons">
                            <button type="button" class="size-btn" data-size="XS">XS</button>
                            <button type="button" class="size-btn" data-size="S">S</button>
                            <button type="button" class="size-btn" data-size="M">M</button>
                            <button type="button" class="size-btn" data-size="L">L</button>
                            <button type="button" class="size-btn" data-size="XL">XL</button>
                            <button type="button" class="size-btn" data-size="XXL">XXL</button>
                            <button type="button" class="size-btn" data-size="FREE">FREE</button>
                        </div>
                    </div>

                    <div class="space-y-2">
                        <label class="text-sm font-medium text-neutral-700">ìƒ‰ìƒ</label>
                        <div class="flex flex-wrap gap-2" id="colorButtons">
                            <button type="button" class="color-btn" data-color="ë¸”ë™">
                                <span class="color-preview" style="background-color: #000;"></span>ë¸”ë™
                            </button>
                            <button type="button" class="color-btn" data-color="í™”ì´íŠ¸">
                                <span class="color-preview" style="background-color: #fff; border: 1px solid #d4d4d4;"></span>í™”ì´íŠ¸
                            </button>
                            <button type="button" class="color-btn" data-color="ê·¸ë ˆì´">
                                <span class="color-preview" style="background-color: #9ca3af;"></span>ê·¸ë ˆì´
                            </button>
                            <button type="button" class="color-btn" data-color="ë² ì´ì§€">
                                <span class="color-preview" style="background-color: #fef3c7;"></span>ë² ì´ì§€
                            </button>
                            <button type="button" class="color-btn" data-color="ë¸Œë¼ìš´">
                                <span class="color-preview" style="background-color: #b45309;"></span>ë¸Œë¼ìš´
                            </button>
                            <button type="button" class="color-btn" data-color="ë„¤ì´ë¹„">
                                <span class="color-preview" style="background-color: #1e3a8a;"></span>ë„¤ì´ë¹„
                            </button>
                            <button type="button" class="color-btn" data-color="ì¹´í‚¤">
                                <span class="color-preview" style="background-color: #15803d;"></span>ì¹´í‚¤
                            </button>
                            <button type="button" class="color-btn" data-color="ë ˆë“œ">
                                <span class="color-preview" style="background-color: #dc2626;"></span>ë ˆë“œ
                            </button>
                        </div>
                    </div>

                    <div class="grid gap-6 md:grid-cols-2">
                        <div class="space-y-2">
                            <label for="stock" class="text-sm font-medium text-neutral-700">ì¬ê³  ìˆ˜ëŸ‰</label>
                            <input type="number" id="stock" 
                                   class="w-full px-3 py-2 border border-neutral-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-neutral-900 focus:border-transparent"
                                   placeholder="0">
                        </div>

                        <div class="space-y-2">
                            <label for="deliveryFee" class="text-sm font-medium text-neutral-700">ë°°ì†¡ë¹„</label>
                            <input type="number" id="deliveryFee" 
                                   class="w-full px-3 py-2 border border-neutral-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-neutral-900 focus:border-transparent"
                                   placeholder="0">
                        </div>
                    </div>

                    <div class="space-y-2">
                        <label for="description" class="text-sm font-medium text-neutral-700">ìƒí’ˆ ì„¤ëª…</label>
                        <textarea id="description" rows="4" 
                                  class="w-full px-3 py-2 border border-neutral-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-neutral-900 focus:border-transparent"
                                  placeholder="ìƒí’ˆì— ëŒ€í•œ ì„¤ëª…ì„ ì…ë ¥í•˜ì„¸ìš”"></textarea>
                    </div>
                </div>
            </div>

            <!-- Detail Images Section -->
            <div class="bg-white p-6 rounded-lg border border-neutral-200 shadow-sm">
                <div class="space-y-4">
                    <div>
                        <label class="text-base font-medium text-neutral-900">ìƒì„¸ ì´ë¯¸ì§€</label>
                        <p class="text-sm text-neutral-500 mt-1">ìƒí’ˆ ìƒì„¸ ì„¤ëª…ì„ ìœ„í•œ ì´ë¯¸ì§€ë¥¼ ë“±ë¡í•˜ì„¸ìš”.</p>
                    </div>
                    
                    <input type="file" id="detailImageInput" accept="image/*" multiple>
                    
                    <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4" id="detailImagesGrid">
                        <!-- Upload Button -->
                        <button type="button" onclick="document.getElementById('detailImageInput').click()" 
                                class="aspect-[3/4] border-2 border-dashed border-neutral-300 rounded-lg hover:border-neutral-400 hover:bg-neutral-50 transition-colors flex flex-col items-center justify-center gap-2 text-neutral-500">
                            <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
                            </svg>
                            <span class="text-sm">ì´ë¯¸ì§€ ì¶”ê°€</span>
                            <span class="text-xs text-neutral-400" id="detailImageCount" style="display: none;">0ì¥</span>
                        </button>
                    </div>
                    
                    <p class="text-sm text-neutral-500" id="detailImageHint" style="display: none;">
                        ğŸ’¡ ì´ë¯¸ì§€ ìœ„ì— ë§ˆìš°ìŠ¤ë¥¼ ì˜¬ë ¤ ìˆœì„œë¥¼ ë³€ê²½í•˜ê±°ë‚˜ ì‚­ì œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤
                    </p>
                </div>
            </div>

            <!-- Submit Buttons -->
            <div class="flex gap-3 justify-end">
                <button type="button" class="btn-secondary" onclick="resetForm()">ì·¨ì†Œ</button>
                <button type="submit" class="btn-primary">ìƒí’ˆ ë“±ë¡</button>
            </div>
        </form>
    </main>

    <script>
        // State
        let productImages = [];
        let detailImages = [];
        let selectedSizes = [];
        let selectedColors = [];

        // Toast notification
        function showToast(message, type = 'success') {
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            toast.textContent = message;
            document.body.appendChild(toast);
            
            setTimeout(() => {
                toast.remove();
            }, 3000);
        }

        // Product Images
        document.getElementById('productImageInput').addEventListener('change', function(e) {
            const files = Array.from(e.target.files);
            
            files.forEach(file => {
                if (productImages.length >= 10) return;
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    productImages.push(e.target.result);
                    renderProductImages();
                };
                reader.readAsDataURL(file);
            });
            
            e.target.value = '';
        });

        function renderProductImages() {
            const grid = document.getElementById('productImagesGrid');
            const uploadBtn = grid.querySelector('button');
            const countSpan = document.getElementById('productImageCount');
            const errorText = document.getElementById('productImageError');
            
            // Clear existing images
            grid.innerHTML = '';
            
            // Re-add upload button if under max
            if (productImages.length < 10) {
                grid.appendChild(uploadBtn);
            }
            
            // Update count
            countSpan.textContent = `${productImages.length}/10`;
            
            // Add image previews
            productImages.forEach((img, index) => {
                const div = document.createElement('div');
                div.className = 'relative aspect-square border border-neutral-200 rounded-lg overflow-hidden group image-upload-preview';
                
                div.innerHTML = `
                    <img src="${img}" alt="ìƒí’ˆ ì´ë¯¸ì§€ ${index + 1}" class="w-full h-full object-cover">
                    ${index === 0 ? '<div class="absolute top-2 left-2 bg-neutral-900 text-white px-2 py-1 rounded text-xs">ëŒ€í‘œ</div>' : ''}
                    <button type="button" onclick="removeProductImage(${index})" 
                            class="hover-controls absolute top-2 right-2 bg-black bg-opacity-60 text-white p-1.5 rounded-full hover:bg-opacity-80">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                        </svg>
                    </button>
                    <div class="absolute bottom-2 right-2 bg-black bg-opacity-60 text-white px-2 py-1 rounded text-xs">
                        ${index + 1}
                    </div>
                `;
                
                grid.appendChild(div);
            });
            
            // Show/hide error
            if (productImages.length < 4) {
                errorText.textContent = `ìµœì†Œ 4ì¥ì˜ ì´ë¯¸ì§€ë¥¼ ë“±ë¡í•´ì£¼ì„¸ìš”. (í˜„ì¬ ${productImages.length}ì¥)`;
                errorText.style.display = 'block';
            } else {
                errorText.style.display = 'none';
            }
        }

        function removeProductImage(index) {
            productImages.splice(index, 1);
            renderProductImages();
        }

        // Detail Images
        document.getElementById('detailImageInput').addEventListener('change', function(e) {
            const files = Array.from(e.target.files);
            
            files.forEach(file => {
                const reader = new FileReader();
                reader.onload = function(e) {
                    detailImages.push(e.target.result);
                    renderDetailImages();
                };
                reader.readAsDataURL(file);
            });
            
            e.target.value = '';
        });

        function renderDetailImages() {
            const grid = document.getElementById('detailImagesGrid');
            const uploadBtn = grid.querySelector('button');
            const countSpan = document.getElementById('detailImageCount');
            const hint = document.getElementById('detailImageHint');
            
            // Clear existing images
            grid.innerHTML = '';
            
            // Re-add upload button
            grid.appendChild(uploadBtn);
            
            // Update count
            if (detailImages.length > 0) {
                countSpan.textContent = `${detailImages.length}ì¥`;
                countSpan.style.display = 'block';
                hint.style.display = 'block';
            } else {
                countSpan.style.display = 'none';
                hint.style.display = 'none';
            }
            
            // Add image previews
            detailImages.forEach((img, index) => {
                const div = document.createElement('div');
                div.className = 'relative aspect-[3/4] border border-neutral-200 rounded-lg overflow-hidden group image-upload-preview';
                
                div.innerHTML = `
                    <img src="${img}" alt="ìƒì„¸ ì´ë¯¸ì§€ ${index + 1}" class="w-full h-full object-cover">
                    <div class="absolute top-2 left-2 bg-black bg-opacity-60 text-white px-2 py-1 rounded text-xs">
                        ${index + 1}
                    </div>
                    <button type="button" onclick="removeDetailImage(${index})" 
                            class="hover-controls absolute top-2 right-2 bg-black bg-opacity-60 text-white p-1.5 rounded-full hover:bg-opacity-80">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                        </svg>
                    </button>
                    <div class="hover-controls absolute bottom-2 right-2 flex gap-1">
                        <button type="button" onclick="moveDetailImage(${index}, ${index - 1})" 
                                ${index === 0 ? 'disabled' : ''}
                                class="bg-black bg-opacity-60 text-white p-1.5 rounded hover:bg-opacity-80 disabled:opacity-30 disabled:cursor-not-allowed"
                                title="ì™¼ìª½ìœ¼ë¡œ ì´ë™">
                            <span class="text-xs">â†</span>
                        </button>
                        <button type="button" onclick="moveDetailImage(${index}, ${index + 1})" 
                                ${index === detailImages.length - 1 ? 'disabled' : ''}
                                class="bg-black bg-opacity-60 text-white p-1.5 rounded hover:bg-opacity-80 disabled:opacity-30 disabled:cursor-not-allowed"
                                title="ì˜¤ë¥¸ìª½ìœ¼ë¡œ ì´ë™">
                            <span class="text-xs">â†’</span>
                        </button>
                    </div>
                `;
                
                grid.appendChild(div);
            });
        }

        function removeDetailImage(index) {
            detailImages.splice(index, 1);
            renderDetailImages();
        }

        function moveDetailImage(fromIndex, toIndex) {
            if (toIndex < 0 || toIndex >= detailImages.length) return;
            
            const [movedImage] = detailImages.splice(fromIndex, 1);
            detailImages.splice(toIndex, 0, movedImage);
            renderDetailImages();
        }

        // Size buttons
        document.getElementById('sizeButtons').addEventListener('click', function(e) {
            if (e.target.classList.contains('size-btn')) {
                e.preventDefault();
                const size = e.target.dataset.size;
                
                if (selectedSizes.includes(size)) {
                    selectedSizes = selectedSizes.filter(s => s !== size);
                    e.target.classList.remove('active');
                } else {
                    selectedSizes.push(size);
                    e.target.classList.add('active');
                }
            }
        });

        // Color buttons
        document.getElementById('colorButtons').addEventListener('click', function(e) {
            const btn = e.target.closest('.color-btn');
            if (btn) {
                e.preventDefault();
                const color = btn.dataset.color;
                
                if (selectedColors.includes(color)) {
                    selectedColors = selectedColors.filter(c => c !== color);
                    btn.classList.remove('active');
                } else {
                    selectedColors.push(color);
                    btn.classList.add('active');
                }
            }
        });

        // Form submission
        document.getElementById('productForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            if (productImages.length < 4) {
                showToast('ìƒí’ˆ ì´ë¯¸ì§€ë¥¼ ìµœì†Œ 4ì¥ ë“±ë¡í•´ì£¼ì„¸ìš”.', 'error');
                return;
            }
            
            const formData = {
                productName: document.getElementById('productName').value,
                brand: document.getElementById('brand').value,
                category: document.getElementById('category').value,
                price: document.getElementById('price').value,
                discountPrice: document.getElementById('discountPrice').value,
                sizes: selectedSizes,
                colors: selectedColors,
                stock: document.getElementById('stock').value,
                deliveryFee: document.getElementById('deliveryFee').value,
                description: document.getElementById('description').value,
                productImages: productImages,
                detailImages: detailImages
            };
            
            console.log('ìƒí’ˆ ì •ë³´:', formData);
            showToast('ìƒí’ˆì´ ì„±ê³µì ìœ¼ë¡œ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤!');
            
            // Optionally reset form
            // resetForm();
        });

        // Reset form
        function resetForm() {
            if (confirm('ì‘ì„± ì¤‘ì¸ ë‚´ìš©ì´ ì‚­ì œë©ë‹ˆë‹¤. ê³„ì†í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                document.getElementById('productForm').reset();
                productImages = [];
                detailImages = [];
                selectedSizes = [];
                selectedColors = [];
                
                document.querySelectorAll('.size-btn, .color-btn').forEach(btn => {
                    btn.classList.remove('active');
                });
                
                renderProductImages();
                renderDetailImages();
            }
        }

        // Initialize
        renderProductImages();
        renderDetailImages();
    </script>
</body>
</html>
